# Langchain Decision Service

μ‚¬μ©μμ promptλ¥Ό λ¶„μ„ν•μ—¬ 4κ°€μ§€ μΉ΄ν…κ³ λ¦¬ μ¤‘ ν•λ‚λ΅ λ¶„λ¥ν•λ” Langchain κΈ°λ° μ‹μ¤ν…μ…λ‹λ‹¤.

## π― λ¶„λ¥ μΉ΄ν…κ³ λ¦¬

1. **λ‚ μ”¨ μ •λ³΄ μ”μ²­** β†’ "λ‚ μ”¨ μ •λ³΄λ¥Ό μ”μ²­ν•μ…¨μµλ‹λ‹¤."
2. **ν•κµ­ μ£Όμ‹ μ‹μ¥ μΆ…λ© μ£Όκ°€ μ •λ³΄ μ”μ²­** β†’ "ν•κµ­ μ£Όμ‹ μ‹μ¥μ— μƒμ¥λμ–΄ μλ” μΆ…λ©μ μ£Όκ°€ κ΄€λ ¨ μ •λ³΄λ¥Ό μ”μ²­ν•μ…¨μµλ‹λ‹¤."
3. **μ›Ή κ²€μƒ‰ ν•„μ”** β†’ "μ •ν™•ν• λ‹µλ³€μ„ μ„ν•΄μ„λ” μ›Ή κ²€μƒ‰μ΄ ν•„μ”ν•©λ‹λ‹¤."
4. **λ°”λ΅ λ‹µλ³€ κ°€λ¥** β†’ "λ°”λ΅ λ‹µλ³€λ“λ¦¬κ² μµλ‹λ‹¤"

## π€ μ„¤μΉ λ° μ„¤μ •

### 1. μμ΅΄μ„± μ„¤μΉ
```bash
pip install -r requirements.txt
```

### 2. OpenAI API ν‚¤ μ„¤μ •
```bash
export OPENAI_API_KEY="your-openai-api-key"
```

### 3. μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰
```bash
cd src
uvicorn main:app --reload --host 0.0.0.0 --port 8000
```

## π“– μ‚¬μ©λ²•

### 1. μ›Ή μΈν„°νμ΄μ¤ μ‚¬μ©
λΈλΌμ°μ €μ—μ„ `http://localhost:8000/decision-test`μ— μ ‘μ†ν•μ—¬ μ›Ή μΈν„°νμ΄μ¤λ¥Ό ν†µν•΄ ν…μ¤νΈν•  μ μμµλ‹λ‹¤.

### 2. API μ§μ ‘ νΈμ¶
```bash
curl -X POST "http://localhost:8000/api/decision/classify" \
     -H "Content-Type: application/json" \
     -d '{"prompt": "μ¤λ μ„μΈ λ‚ μ”¨λ” μ–΄λ•?", "use_async": true}'
```

### 3. Python μ¤ν¬λ¦½νΈ ν…μ¤νΈ
```bash
python test_decision_service.py
```

## π”§ API μ—”λ“ν¬μΈνΈ

### POST /api/decision/classify
μ‚¬μ©μμ promptλ¥Ό λ¶„λ¥ν•©λ‹λ‹¤.

**μ”μ²­ λ³Έλ¬Έ:**
```json
{
    "prompt": "λ¶„λ¥ν•  μ§λ¬Έ",
    "use_async": true
}
```

**μ‘λ‹µ:**
```json
{
    "user_prompt": "λ¶„λ¥ν•  μ§λ¬Έ",
    "decision_result": "λ¶„λ¥ κ²°κ³Ό λ©”μ‹μ§€",
    "success": true,
    "error_message": null
}
```

### GET /api/decision/health
μ„λΉ„μ¤ μƒνƒλ¥Ό ν™•μΈν•©λ‹λ‹¤.

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

```
src/
β”β”€β”€ services/
β”‚   β””β”€β”€ langchain_decision_service.py  # ν•µμ‹¬ μμ‚¬κ²°μ • μ„λΉ„μ¤
β”β”€β”€ api/
β”‚   β””β”€β”€ decision_api.py                # API μ—”λ“ν¬μΈνΈ
β”β”€β”€ main.py                            # FastAPI λ©”μΈ μ• ν”λ¦¬μΌ€μ΄μ…
templates/
β””β”€β”€ decision_test.html                 # μ›Ή ν…μ¤νΈ μΈν„°νμ΄μ¤
test_decision_service.py               # Python ν…μ¤νΈ μ¤ν¬λ¦½νΈ
```

## π§ ν…μ¤νΈ μμ‹

### λ‚ μ”¨ κ΄€λ ¨
- "μ¤λ μ„μΈ λ‚ μ”¨λ” μ–΄λ•?"
- "λ‚΄μΌ λΉ„ μ¬ ν™•λ¥ μ€?"
- "μ£Όλ§ λ‚ μ”¨ μλ³΄"

### ν•κµ­ μ£Όμ‹ κ΄€λ ¨
- "μ‚Όμ„±μ „μ μ£Όκ°€κ°€ μ–΄λ–»κ² λλ‚μ”?"
- "KOSPI μ§€μλ” ν„μ¬ λ‡ μ μΈκ°€μ”?"
- "SKν•μ΄λ‹‰μ¤ μ£Όκ°€ μ •λ³΄"

### μ›Ή κ²€μƒ‰ ν•„μ”
- "2024λ…„ μµμ‹  μ•„μ΄ν° κ°€κ²©μ€?"
- "ν„μ¬ μ‹κ°„μ΄ λ‡ μ‹μΈκ°€μ”?"
- "μ¤λ λ‚ μ§λ”?"

### λ°”λ΅ λ‹µλ³€ κ°€λ¥
- "νμ΄μ¬μ΄λ€ λ¬΄μ—‡μΈκ°€μ”?"
- "μ„Έκ³„μ—μ„ κ°€μ¥ ν° λ‚λΌλ”?"
- "μΈκ³µμ§€λ¥μ μ •μλ”?"

## π” λ¶„λ¥ κΈ°μ¤€

### 1. λ‚ μ”¨ κ΄€λ ¨ μ •λ³΄ μ”μ²­
- λ‚ μ”¨, κΈ°μ¨, κ°•μ, λ‚ μ”¨ μλ³΄, κΈ°ν›„ λ“±κ³Ό κ΄€λ ¨λ μ§λ¬Έ
- ν‚¤μ›λ“: λ‚ μ”¨, κΈ°μ¨, λΉ„, λ, λ§‘μ, νλ¦Ό, μµλ„, κΈ°μ•• λ“±

### 2. ν•κµ­ μ£Όμ‹ μ‹μ¥ μΆ…λ© μ£Όκ°€ μ •λ³΄ μ”μ²­
- ν•κµ­ μ£Όμ‹, KOSPI, KOSDAQ, νΉμ • μΆ…λ© μ£Όκ°€, μ£Όμ‹ μ‹μ¥ λ“±κ³Ό κ΄€λ ¨λ μ§λ¬Έ
- ν‚¤μ›λ“: μ£Όκ°€, μ£Όμ‹, KOSPI, KOSDAQ, μ‚Όμ„±μ „μ, SKν•μ΄λ‹‰μ¤ λ“±

### 3. μ›Ή κ²€μƒ‰ ν•„μ”
- μµμ‹  μ •λ³΄, μ‹¤μ‹κ°„ λ°μ΄ν„°, νΉμ • μ‚¬μ΄νΈ μ •λ³΄, ν„μ¬ μ‹μ μ κµ¬μ²΄μ μΈ μ •λ³΄κ°€ ν•„μ”ν• μ§λ¬Έ
- ν‚¤μ›λ“: ν„μ¬, μ§€κΈ, μ‹¤μ‹κ°„, μµμ‹ , κ°€κ²©, μ‹κ°„, λ‚ μ§ λ“±

### 4. λ°”λ΅ λ‹µλ³€ κ°€λ¥
- μΌλ°μ μΈ μ§€μ‹, κ°λ… μ„¤λ…, μ—­μ‚¬μ  μ‚¬μ‹¤, κ³µμ‹ λ“± AIκ°€ κ°€μ§„ μ •λ³΄λ΅ λ‹µλ³€ κ°€λ¥ν• μ§λ¬Έ
- ν‚¤μ›λ“: μ •μ, κ°λ…, μ—­μ‚¬, κ³µμ‹, μ›λ¦¬ λ“±

## π› οΈ κ°λ°μ μ •λ³΄

### μ£Όμ” μ»΄ν¬λ„νΈ

1. **LangchainDecisionService**: ν•µμ‹¬ λ¶„λ¥ λ΅μ§
   - `classify_prompt()`: λΉ„λ™κΈ° λ¶„λ¥
   - `classify_prompt_sync()`: λ™κΈ° λ¶„λ¥

2. **DecisionCategory**: λ¶„λ¥ μΉ΄ν…κ³ λ¦¬ μ—΄κ±°ν•
   - WEATHER, KOREAN_STOCK, WEB_SEARCH_NEEDED, DIRECT_ANSWER

3. **API μ—”λ“ν¬μΈνΈ**: RESTful API μ κ³µ
   - POST /api/decision/classify
   - GET /api/decision/health

### ν™•μ¥ κ°€λ¥μ„±

- μƒλ΅μ΄ λ¶„λ¥ μΉ΄ν…κ³ λ¦¬ μ¶”κ°€
- λ¶„λ¥ μ •ν™•λ„ ν–¥μƒμ„ μ„ν• ν”„λ΅¬ν”„νΈ μµμ ν™”
- λ‹¤μ–‘ν• AI λ¨λΈ μ§€μ› (Ollama, Anthropic λ“±)
- λ¶„λ¥ κ²°κ³Ό λ΅κΉ… λ° λ¶„μ„ κΈ°λ¥

## π“ λΌμ΄μ„ μ¤

μ΄ ν”„λ΅μ νΈλ” MIT λΌμ΄μ„ μ¤ ν•μ— λ°°ν¬λ©λ‹λ‹¤. 